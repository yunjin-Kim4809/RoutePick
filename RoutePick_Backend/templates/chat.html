<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>RoutePick Chat & Map Service</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Google Maps API (.env íŒŒì¼ì˜ GOOGLE_MAPS_API_KEY ì‚¬ìš©) -->
    {% if google_maps_api_key %}
    <script src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&v=weekly&loading=async&libraries=geometry" async defer></script>
    {% else %}
    <script>
        console.error("âš ï¸ Google Maps API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. .env íŒŒì¼ì— GOOGLE_MAPS_API_KEYë¥¼ ì¶”ê°€í•˜ì„¸ìš”.");
    </script>
    {% endif %}
</head>
<body>
    <div class="main-container">
        <!-- (a) ì¢Œì¸¡ ì±—ë´‡ ì„¹ì…˜ -->
        <section class="left-pane">
            <header class="chat-header">
                <h1>AI ê°€ì´ë“œ</h1>
                <!-- [ì—¬ê¸°!] ì´ ë²„íŠ¼ì„ ì¶”ê°€í•˜ì„¸ìš” -->
                <a href="/api/generate-card/{{ task_id }}" download 
                    style="
                        position: absolute; 
                        top: 15px; 
                        right: 15px; 
                        padding: 8px 12px; 
                        background-color: #C5A683; 
                        color: white; 
                        text-decoration: none; 
                        border-radius: 5px; 
                        font-size: 14px;
                        font-weight: bold;
                    ">
                    ğŸ–¼ï¸ ì¹´ë“œ ì €ì¥
                </a>
                            
            </header>
            <div id="chat-window" class="chat-window">
                <!-- ì±„íŒ… ë‚´ìš©ì´ ì—¬ê¸° ìŒ“ì…ë‹ˆë‹¤ -->
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”...">
                <button id="send-btn">ì „ì†¡</button>
            </div>
        </section>

        <!-- ìš°ì¸¡ ì„¹ì…˜ -->
        <section class="right-pane">
            <!-- (b) ìƒë‹¨ êµ¬ê¸€ ì§€ë„ -->
            <div id="map-container"></div>
            
            <!-- ê²½ë¡œ ì•ˆë‚´ ë²„íŠ¼ -->
            <button id="route-guide-btn" class="route-guide-btn">ê²½ë¡œ ì•ˆë‚´</button>

            <!-- (c) í•˜ë‹¨ ì¹´ë“œ í–‰ë ¬ -->
            <div id="card-matrix" class="card-matrix"></div>

            <!-- (d) í–„ë²„ê±° ë²„íŠ¼ ë° ì‚¬ì´ë“œ ë©”ë‰´ -->
            <button id="menu-toggle" class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
            <nav id="side-menu" class="side-menu"></nav>
        </section>
    </div>

    <!-- task_idë¥¼ JavaScript ë³€ìˆ˜ë¡œ ì „ë‹¬ -->
    <script>
        window.TASK_ID = "{{ task_id }}";
    </script>
    <script src="{{ url_for('static', filename='js/script.js') }}" defer></script>
    <!-- ì±—ë´‡ ë¡œì§ ë™ì  ë¡œë“œ -->
    <script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>
</body>
</html>